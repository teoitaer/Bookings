<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <meta http-equiv="Permissions-Policy" content="interest-cohort=()">
  <title>PA BOOKINGS</title>
  <link rel="stylesheet" href="app.css" />
</head>
<body>
  <div class="container">
    <div id="home" class="flex-center flex-column">
      <h1>PA BOOKINGS</h1>

      <div class="form-group">
        <div style="text-align:center;">
          <label class="lab" for="first_name">First Name</label>
        </div>
        <input class="form-control form-control-sm" type="text" id="first_name" name="first_name" placeholder="First Name">
      </div>

      <div class="form-group">
        <div style="text-align:center;">
          <label class="lab" for="last_name">Last Name</label>
        </div>
        <input class="form-control form-control-sm" type="text" id="last_name" name="last_name" placeholder="Last Name">
      </div>

      <div class="form-group">
        <div style="text-align:center;">
          <label class="lab" for="email">Email</label>
        </div>
        <input class="form-control form-control-sm" type="email" id="email" name="email" placeholder="Email">
      </div>

      <div>
        <h1>Seleziona un'opzione</h1>
        <select id="dropdown">
          <option value="">Seleziona...</option>
        </select>
      </div>

      <div class="form-group">
        <div style="text-align:center;">
          <label class="lab" for="Selezione_Materie">Select Subject</label>
        </div>
        <input class="form-control form-control-sm" type="text" id="Selezione_Materie" name="Selezione_Materie" placeholder="Selezione Materie">
      </div>

      <button type="submit" class="btn btn-primary" onclick="sendData()">Submit</button>

      
      <script>
        // URL dell'app web di Google Apps Script
        var scriptUrl = 'https://script.google.com/macros/s/AKfycbwV7vV8BaFH0ZgKqqEEXXAvPz45tXGJ8ausvFqcUsA6eChPpyuorI5MEreV-Ying47J/exec';

        
        // Funzione per popolare il dropdown
        function populateDropdown() {
          var dropdown = document.getElementById('dropdown');
          
          // Richiesta per ottenere i dati
          fetch(scriptUrl)
            .then(response => response.json())
            .then(data => {
              // Assicurati che i dati siano validi
              if (Array.isArray(data)) {
                data.forEach(item => {
                  var option = document.createElement('option');
                  option.value = item;
                  option.textContent = item;
                  dropdown.appendChild(option);
                });
              }
            })
            .catch(error => console.error('Errore:', error));
        }
        
        // Chiama la funzione per popolare il dropdown quando la pagina viene caricata
        document.addEventListener('DOMContentLoaded', populateDropdown);



        
        // Funzione per inviare i dati
        function sendData() {
          var firstName = document.getElementById('first_name').value;
          var lastName = document.getElementById('last_name').value;
          var email = document.getElementById('email').value;
          var dropdownValue = document.getElementById('dropdown').value;
          var subject = document.getElementById('Selezione_Materie').value;
          
          fetch(scriptUrl, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ 
              first_name: firstName,
              last_name: lastName,
              email: email,
              dropdown: dropdownValue,
              subject: subject
            })
          })
          .then(response => response.text())
          .then(data => {
            alert('Dati inviati con successo!');
            // Pulisci i campi dopo l'invio
            document.getElementById('first_name').value = '';
            document.getElementById('last_name').value = '';
            document.getElementById('email').value = '';
            document.getElementById('dropdown').value = '';
            document.getElementById('Selezione_Materie').value = '';
          })
          .catch(error => {
            console.error('Errore:', error);
            alert('Errore durante l\'invio dei dati.');
          });
        }
      </script>
    </div>
  </div>
</body>
</html>
